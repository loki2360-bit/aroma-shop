<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ú–µ–±–µ–ª—å–Ω—ã–π –ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä Lite</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background: #f4f4f9; margin: 0; padding: 20px; display: flex; flex-direction: column; align-items: center; }
        h1 { color: #333; }
        
        .container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            max-width: 1200px;
            width: 100%;
            justify-content: center;
        }

        .controls {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            flex: 1;
            min-width: 300px;
        }

        .preview {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            flex: 2;
            min-width: 300px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .input-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; font-weight: bold; color: #555; }
        input { width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; box-sizing: border-box; }
        
        button {
            width: 100%;
            padding: 12px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            transition: 0.3s;
        }
        button:hover { background: #0056b3; }

        canvas { border: 1px solid #eee; background: #fff; max-width: 100%; }
        
        .parts-list { margin-top: 20px; width: 100%; }
        table { width: 100%; border-collapse: collapse; margin-top: 10px; font-size: 14px; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
        th { background: #f8f8f8; }
    </style>
</head>
<body>

    <h1>üõ†Ô∏è –ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –®–∫–∞—Ñ–∞</h1>

    <div class="container">
        <!-- –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è -->
        <div class="controls">
            <h3>–ü–∞—Ä–∞–º–µ—Ç—Ä—ã</h3>
            <div class="input-group">
                <label>–û–±—â–∞—è –®–∏—Ä–∏–Ω–∞ (–º–º):</label>
                <input type="number" id="width" value="800">
            </div>
            <div class="input-group">
                <label>–û–±—â–∞—è –í—ã—Å–æ—Ç–∞ (–º–º):</label>
                <input type="number" id="height" value="2000">
            </div>
            <div class="input-group">
                <label>–ì–ª—É–±–∏–Ω–∞ (–º–º):</label>
                <input type="number" id="depth" value="600">
            </div>
            <div class="input-group">
                <label>–¢–æ–ª—â–∏–Ω–∞ –º–∞—Ç–µ—Ä–∏–∞–ª–∞ (–º–º):</label>
                <input type="number" id="thickness" value="16">
            </div>
            <div class="input-group">
                <label>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª–æ–∫:</label>
                <input type="number" id="shelves" value="3" min="0">
            </div>
            <button onclick="calculateAndDraw()">–†–∞—Å—Å—á–∏—Ç–∞—Ç—å –∏ –ù–∞—á–µ—Ä—Ç–∏—Ç—å</button>

            <div class="parts-list" id="partsList">
                <!-- –°—é–¥–∞ –ø–æ–ø–∞–¥–µ—Ç —Ç–∞–±–ª–∏—Ü–∞ –¥–µ—Ç–∞–ª–µ–π -->
            </div>
        </div>

        <!-- –û–±–ª–∞—Å—Ç—å —á–µ—Ä—Ç–µ–∂–∞ -->
        <div class="preview">
            <h3>–°—Ö–µ–º–∞ (–§—Ä–æ–Ω—Ç–∞–ª—å–Ω—ã–π –≤–∏–¥)</h3>
            <canvas id="canvas" width="600" height="400"></canvas>
            <p style="color: #777; font-size: 12px;">*–ß–µ—Ä—Ç–µ–∂ —Å—Ö–µ–º–∞—Ç–∏—á–Ω—ã–π, –≤–∏–¥ —Å–ø–µ—Ä–µ–¥–∏</p>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        const partsListDiv = document.getElementById('partsList');

        function calculateAndDraw() {
            // 1. –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ
            const W = parseFloat(document.getElementById('width').value);
            const H = parseFloat(document.getElementById('height').value);
            const D = parseFloat(document.getElementById('depth').value);
            const T = parseFloat(document.getElementById('thickness').value);
            const shelvesCount = parseInt(document.getElementById('shelves').value);

            // 2. –õ–æ–≥–∏–∫–∞ —Ä–∞—Å—á–µ—Ç–∞ (–¢–∏–ø–∏—á–Ω–∞—è —Å–±–æ—Ä–∫–∞: –ø–æ–ª–∫–∏ –º–µ–∂–¥—É —Å—Ç–µ–Ω–∫–∞–º–∏)
            // –ë–æ–∫–æ–≤–∏–Ω—ã (–õ–µ–≤–∞—è –∏ –ü—Ä–∞–≤–∞—è)
            const sideHeight = H;
            const sideDepth = D;
            
            // –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–µ –¥–µ—Ç–∞–ª–∏ (–ö—Ä—ã—à–∞, –î–Ω–æ, –ü–æ–ª–∫–∏)
            // –®–∏—Ä–∏–Ω–∞ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π = –û–±—â–∞—è —à–∏—Ä–∏–Ω–∞ - 2 —Ç–æ–ª—â–∏–Ω—ã —Å—Ç–µ–Ω–æ–∫
            const innerWidth = W - (2 * T); 
            const horizDepth = D; // –ì–ª—É–±–∏–Ω–∞ –æ–±—ã—á–Ω–æ —Ç–∞–∫–∞—è –∂–µ –∏–ª–∏ –º–µ–Ω—å—à–µ –Ω–∞ —Ç–æ–ª—â–∏–Ω—É –∫—Ä–æ–º–∫–∏/–¥–≤–µ—Ä–µ–π, –æ—Å—Ç–∞–≤–∏–º D –¥–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã

            // –í—ã—Å–æ—Ç–∞ –æ–¥–Ω–æ–π —Å–µ–∫—Ü–∏–∏ (–¥–ª—è –ø–æ–ª–æ–∫)
            // –°—á–∏—Ç–∞–µ–º, —á—Ç–æ –∫—Ä—ã—à–∞ –∏ –¥–Ω–æ —Ç–æ–∂–µ –µ—Å—Ç—å. 
            // –ü–æ–ª–µ–∑–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –ø–æ –≤—ã—Å–æ—Ç–µ = H - (–¢–æ–ª—â–∏–Ω–∞ –∫—Ä—ã—à–∏) - (–¢–æ–ª—â–∏–Ω–∞ –¥–Ω–∞)
            // –ù–æ –≤ –ø—Ä–æ—Å—Ç–æ–π —Å—Ö–µ–º–µ —á–∞—Å—Ç–æ –¥–Ω–æ —Å—Ç–æ–∏—Ç –Ω–∞ –ø–æ–ª—É, –∞ –∫—Ä—ã—à–∞ —Å–≤–µ—Ä—Ö—É.
            // –£–ø—Ä–æ—Å—Ç–∏–º: –ü–æ–ª–∫–∏ –¥–µ–ª—è—Ç –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –º–µ–∂–¥—É –¥–Ω–æ–º –∏ –∫—Ä—ã—à–∫–æ–π.
            const spaceForShelves = H - (2 * T); 
            const shelfStep = shelvesCount > 0 ? spaceForShelves / (shelvesCount + 1) : 0;

            // –°–ø–∏—Å–æ–∫ –¥–µ—Ç–∞–ª–µ–π –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã
            let parts = [
                { name: "–ë–æ–∫–æ–≤–∏–Ω–∞ –õ–µ–≤–∞—è", qty: 1, w: T, h: sideHeight, d: sideDepth },
                { name: "–ë–æ–∫–æ–≤–∏–Ω–∞ –ü—Ä–∞–≤–∞—è", qty: 1, w: T, h: sideHeight, d: sideDepth },
                { name: "–ö—Ä—ã—à–∞", qty: 1, w: innerWidth, h: T, d: horizDepth },
                { name: "–î–Ω–æ", qty: 1, w: innerWidth, h: T, d: horizDepth }
            ];

            for(let i=0; i<shelvesCount; i++) {
                parts.push({ name: `–ü–æ–ª–∫–∞ ${i+1}`, qty: 1, w: innerWidth, h: T, d: horizDepth });
            }

            // 3. –û—Ç—Ä–∏—Å–æ–≤–∫–∞ —Ç–∞–±–ª–∏—Ü—ã
            let html = `<h4>–°–ø–∏—Å–æ–∫ –¥–µ—Ç–∞–ª–µ–π (—Ä–∞—Å–∫—Ä–æ–π):</h4>
                        <table>
                            <thead><tr><th>–î–µ—Ç–∞–ª—å</th><th>–ö–æ–ª-–≤–æ</th><th>–î–ª–∏–Ω–∞ (–º–º)</th><th>–®–∏—Ä–∏–Ω–∞ (–º–º)</th><th>–ì–ª—É–±–∏–Ω–∞ (–º–º)</th></tr></thead>
                            <tbody>`;
            
            parts.forEach(p => {
                // –í —Ç–∞–±–ª–∏—Ü–µ –æ–±—ã—á–Ω–æ –î–ª–∏–Ω–∞ - —ç—Ç–æ –±–æ–ª—å—à–∞—è —Å—Ç–æ—Ä–æ–Ω–∞, –®–∏—Ä–∏–Ω–∞ - –º–µ–Ω—å—à–∞—è (–¥–ª—è —Å—Ç–∞–Ω–∫–∞)
                // –ù–æ –¥–ª—è –Ω–∞–≥–ª—è–¥–Ω–æ—Å—Ç–∏ –≤—ã–≤–µ–¥–µ–º –∫–∞–∫ –µ—Å—Ç—å –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ —á–µ—Ä—Ç–µ–∂–∞
                html += `<tr><td>${p.name}</td><td>${p.qty}</td><td>${p.w}</td><td>${p.h}</td><td>${p.d}</td></tr>`;
            });
            html += `</tbody></table>`;
            partsListDiv.innerHTML = html;

            // 4. –û—Ç—Ä–∏—Å–æ–≤–∫–∞ –Ω–∞ Canvas
            drawCabinet(W, H, T, shelvesCount, shelfStep);
        }

        function drawCabinet(W, H, T, shelvesCount, shelfStep) {
            // –û—á–∏—Å—Ç–∫–∞
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –º–∞—Å—à—Ç–∞–±–∞, —á—Ç–æ–±—ã –≤–ª–µ–∑–ª–æ –≤ –∫–∞–Ω–≤–∞—Å
            const padding = 40;
            const availW = canvas.width - (padding * 2);
            const availH = canvas.height - (padding * 2);
            
            const scaleX = availW / W;
            const scaleY = availH / H;
            const scale = Math.min(scaleX, scaleY); // –ë–µ—Ä–µ–º –º–µ–Ω—å—à–∏–π –º–∞—Å—à—Ç–∞–±, —á—Ç–æ–±—ã –≤–ª–µ–∑–ª–æ —Ü–µ–ª–∏–∫–æ–º

            const startX = padding + (availW - (W * scale)) / 2;
            const startY = padding + (availH - (H * scale)) / 2;

            ctx.lineWidth = 2;
            ctx.strokeStyle = '#333';
            ctx.font = '12px Arial';
            ctx.fillStyle = '#000';

            // –§—É–Ω–∫—Ü–∏—è —Ä–∏—Å–æ–≤–∞–Ω–∏—è –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫–∞ —Å —Ä–∞–∑–º–µ—Ä–∞–º–∏
            function drawRect(x, y, w, h, labelW, labelH) {
                const rx = startX + x * scale;
                const ry = startY + y * scale;
                const rw = w * scale;
                const rh = h * scale;

                ctx.strokeRect(rx, ry, rw, rh);

                // –ü–æ–¥–ø–∏—Å–∏ —Ä–∞–∑–º–µ—Ä–æ–≤ (—É–ø—Ä–æ—â–µ–Ω–Ω–æ –≤–Ω—É—Ç—Ä–∏ –¥–µ—Ç–∞–ª–∏, –µ—Å–ª–∏ –≤–ª–µ–∑–∞–µ—Ç)
                ctx.textAlign = "center";
                ctx.textBaseline = "middle";
                
                if (rw > 40 && rh > 20) {
                     ctx.fillText(`${Math.round(w)}x${Math.round(h)}`, rx + rw/2, ry + rh/2);
                }
            }

            // --- –†–ò–°–£–ï–ú –î–ï–¢–ê–õ–ò ---

            // 1. –õ–µ–≤–∞—è —Å—Ç–µ–Ω–∫–∞
            // –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã: x=0, y=0. –®–∏—Ä–∏–Ω–∞=T, –í—ã—Å–æ—Ç–∞=H
            drawRect(0, 0, T, H, "–°—Ç–µ–Ω–∫–∞ –õ", "–í—ã—Å–æ—Ç–∞");

            // 2. –ü—Ä–∞–≤–∞—è —Å—Ç–µ–Ω–∫–∞
            // –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã: x=W-T, y=0
            drawRect(W - T, 0, T, H, "–°—Ç–µ–Ω–∫–∞ –ü", "–í—ã—Å–æ—Ç–∞");

            // 3. –ö—Ä—ã—à–∞ (–º–µ–∂–¥—É —Å—Ç–µ–Ω–∫–∞–º–∏)
            // x=T, y=0. –®–∏—Ä–∏–Ω–∞=Inner, –í—ã—Å–æ—Ç–∞=T
            drawRect(T, 0, W - 2*T, T, "–ö—Ä—ã—à–∞", "–¢–æ–ª—â");

            // 4. –î–Ω–æ (–º–µ–∂–¥—É —Å—Ç–µ–Ω–∫–∞–º–∏)
            // x=T, y=H-T
            drawRect(T, H - T, W - 2*T, T, "–î–Ω–æ", "–¢–æ–ª—â");

            // 5. –ü–æ–ª–∫–∏
            for(let i=0; i<shelvesCount; i++) {
                // –ü–æ–∑–∏—Ü–∏—è Y: –æ—Ç—Å—Ç—É–ø–∞–µ–º –æ—Ç –≤–µ—Ä—Ö–∞ (–¢–æ–ª—â–∏–Ω–∞ –∫—Ä—ã—à–∏) + —à–∞–≥ * (–Ω–æ–º–µ—Ä –ø–æ–ª–∫–∏ + 1)
                // –ù–æ —É –Ω–∞—Å –ø–æ–ª–∫–∏ —Å—á–∏—Ç–∞—é—Ç—Å—è —Å–Ω–∏–∑—É –≤–≤–µ—Ä—Ö –æ–±—ã—á–Ω–æ, –∏–ª–∏ —Å–≤–µ—Ä—Ö—É. 
                // –ü—É—Å—Ç—å –±—É–¥—É—Ç —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ.
                // Y = T (–∫—Ä—ã—à–∞) + (i+1) * —à–∞–≥
                const shelfY = T + ((i + 1) * shelfStep);
                drawRect(T, shelfY - (T/2), W - 2*T, T, `–ü–æ–ª–∫–∞ ${i+1}`, "");
            }

            // --- –û–ë–©–ò–ï –ì–ê–ë–ê–†–ò–¢–´ (–í—ã–Ω–æ—Å–∫–∏) ---
            ctx.strokeStyle = '#007bff';
            ctx.lineWidth = 1;
            
            // –®–∏—Ä–∏–Ω–∞ –æ–±—â–∞—è
            ctx.beginPath();
            ctx.moveTo(startX, startY + H*scale + 20);
            ctx.lineTo(startX + W*scale, startY + H*scale + 20);
            ctx.stroke();
            ctx.fillStyle = '#007bff';
            ctx.fillText(`–®–∏—Ä–∏–Ω–∞: ${W}–º–º`, startX + (W*scale)/2, startY + H*scale + 35);

            // –í—ã—Å–æ—Ç–∞ –æ–±—â–∞—è
            ctx.beginPath();
            ctx.moveTo(startX - 20, startY);
            ctx.lineTo(startX - 20, startY + H*scale);
            ctx.stroke();
            ctx.fillText(`–í—ã—Å–æ—Ç–∞: ${H}–º–º`, startX - 50, startY + (H*scale)/2);
        }

        // –ó–∞–ø—É—Å–∫ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        calculateAndDraw();
    </script>
</body>
</html>
